# FastP trimming
$fastp \
    -i "$R1" -I "$R2" \
    -o "$OUT_R1" -O "$OUT_R2" \
    --detect_adapter_for_pe \
    --trim_poly_g \
    --thread 8 \
    --html "$HTML_REPORT" \
    --json "$JSON_REPORT"

# STAR mapping
$STAR --runThreadN $THREADS \
    --genomeDir ./star_transcriptome_index \
    --readFilesIn $R1 $R2 \
    --readFilesCommand zcat \
    --outFileNamePrefix $OUT_PREFIX \
    --outSAMtype BAM SortedByCoordinate \
    --quantMode GeneCounts

# featuresCounts
# featureCounts -T $THREADS -p -B -C --countReadPairs -g gene_id -a spongilla_transcriptome_annotated_200501.gtf -o featuresCounts_trans_clean_out/counts.txt star_trans_clean_out/*.bam